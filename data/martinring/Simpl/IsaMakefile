## configurables

SESSION-NAME = Simpl
BASE-IMAGE = HOL

## targets

default: $(SESSION-NAME)
test: 
# usually empty:
images: $(SESSION-NAME)

all: images test


## global settings

SRC = $(ISABELLE_HOME)/src
OUT = $(ISABELLE_OUTPUT)
LOG = $(OUT)/log

# turn image into absolute path according to ISABELLE_IMAGE_PATH or OUT
ifeq ($(ISABELLE_IMAGE_PATH),)
IMAGE=$(OUT)/$(BASE-IMAGE)
else
IMAGE=$(ISABELLE_IMAGE_PATH)$(BASE-IMAGE)
endif


USEDIR = $(ISABELLE_TOOL) usedir -g true -v true -i true -V outline=/proof,/ML -d pdf -P "http://isabelle.in.tum.de/library/" # -D generated

# time limit (in sec)
MAXTIME = 3600


## dependencies

$(SESSION-NAME): $(OUT)/$(SESSION-NAME)

$(OUT)/$(SESSION-NAME): $(IMAGE) ROOT.ML *.ML *.thy document/*.tex document/*.bib ex/*.thy
	ulimit -t $(MAXTIME); $(USEDIR) -b $(IMAGE) $(SESSION-NAME)


keywords: $(LOG)/Simpl.gz $(LOG)/Pure.gz $(LOG)/Pure-ProofGeneral.gz $(LOG)/HOL.gz \
	  $(LOG)/HOLCF.gz $(LOG)/IOA.gz \
	  $(LOG)/HOL-Nominal.gz $(LOG)/HOL-Statespace.gz
	$(ISABELLE_TOOL) keywords -t emacs -k simpl \
	  $(LOG)/Pure.gz $(LOG)/Pure-ProofGeneral.gz $(LOG)/HOL.gz $(LOG)/HOLCF.gz \
	  $(LOG)/IOA.gz $(LOG)/HOL-Nominal.gz $(LOG)/HOL-Statespace.gz \
	  $(LOG)/Simpl.gz

## clean

clean:
	@rm -f $(LOG)/$(SESSION-NAME).gz


