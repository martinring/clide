## configurables

SESSION-NAME = Dijkstra_Shortest_Path
BASE-IMAGE = Refine_Monadic

## targets

default: $(SESSION-NAME)
test: $(SESSION-NAME)
# usually empty:
images:  

all: images test


## global settings

SRC = $(ISABELLE_HOME)/src
OUT = $(ISABELLE_OUTPUT)
LOG = $(OUT)/log

# BASE-IMAGE not from distribution
IMAGE=$(OUT)/$(BASE-IMAGE)

# Isabelle library path already set in base image
USEDIR = $(ISABELLE_TOOL) usedir -v true -i true -V outline=/proof,/ML -d pdf

# time limit (in sec)
MAXTIME = 3600


## dependencies

$(SESSION-NAME): $(BASE-IMAGE) $(LOG)/$(BASE-IMAGE)-$(SESSION-NAME).gz

$(BASE-IMAGE):
	@cd ../$(BASE-IMAGE); $(ISABELLE_TOOL) make

$(LOG)/$(BASE-IMAGE)-$(SESSION-NAME).gz: $(IMAGE) ROOT.ML *.thy document/*.tex document/*.bib
	cd ..; ulimit -t $(MAXTIME); $(USEDIR) $(IMAGE) $(SESSION-NAME)


## clean

clean:
	@rm -f $(LOG)/$(SESSION-NAME).gz
